<!DOCTYPE html>
<html lang="en">
<head>
  <title>rad - general purpose, typed build tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism-okaidia.min.css" rel="stylesheet" />
<style>
/**
 * override okaidia bogus operator
 */
.token.operator {
 background-color: transparent !important;
}

/* page */
@import url(https://fonts.googleapis.com/css?family=Open+Sans:800);
html, body {
  height: 100%;
  margin: 0;
  width: 100vw;
}
a, a:visited {color:#2196f3;} /* Visited link    */
table {
  display: block;
  overflow-x: scroll;
}

/* hero */
.baby-rad {
  transition: all 5s;
}
svg text {
  fill: white;
  stroke-width: 1;
  stroke: beige;
}

/* content */
body {
  font-family: sans-serif;
  background-color: #303030;
  color: white;
}
div.content {
  margin: auto;
  max-width: 800px;
  padding: 1em;
}
svg {
  background: #303030;
  font: 5em/1 Open Sans, Impact;
  text-transform: uppercase;
  margin: 0;
  width: 100%;
  height: 300px;
}
#big_baby {
  cursor: pointer;
}
</style>
</head>
<body>
<svg id=radness viewBox="0 0 800 300">
  <symbol id="repeatme">
    <text text-anchor="middle" x="0" y="0" dx='1em' dy="1em">RAD</text>
  </symbol>
  <g id="repeats" />
  <use class="text" xlink:href="#big_baby" />
  <symbol id="big_baby">
    <text text-anchor="middle" x="85%" y="80%" dy=".35em">RAD</text>
  </symbol>
</svg>
<div class='content'>
  <h1 id="rad-💯">rad 💯</h1>
<p>a general purpose build tool.</p>
<p>statically typed, batteries included. command tasks, function tasks, and make-style tasks support.</p>
<p><img src="https://github.com/cdaringe/rad/workflows/master/badge.svg" alt="master"></p>
<p>jump to:</p>
<ol>
<li><a href="https://cdaringe.github.io/rad/">documentation site</a></li>
<li><a href="#usage">usage</a></li>
<li><a href="#install">install</a></li>
<li><a href="#what-is-it">what</a></li>
<li><a href="#what-is-it">why</a></li>
<li><a href="#why-not-my-favorite-build-tool">why not <code>&lt;my-favorite-build-tool&gt;</code>?</a></li>
<li><a href="https://cdaringe.github.io/rad/#manual">manual</a></li>
</ol>
<h2 id="usage">usage</h2>
<p><code>$ rad &lt;task-name&gt; [--help]</code></p>
<pre><code class="language-ts">// rad.ts
import { Tasks } from &quot;https://raw.githubusercontent.com/cdaringe/rad/master/src/mod.ts&quot;;

// command tasks
const format = `prettier --write`
const test = `deno test`

// function tasks
const compile = {
  dependsOn: [format],
  fn({ sh, ...toolkit }) =&gt; sh(&#39;tsc&#39;)
}

// make-style tasks
const transpile = {
  target: &quot;phony&quot;,
  prereqs: [&quot;p1&quot;, &quot;p2&quot;],
  async onMake({ logger }, { changedPrereqs /*, prereqs */}) {
    for await (const req of changedPrereqs) {
      logger.info(`req: ${req.filename} ${JSON.stringify(req.info)}`);
    }
  },
}

export const tasks: Tasks = {
  compile,
  format,
  test
}</code></pre>
<h2 id="install">install</h2>
<p>there are a few formal ways to use <code>rad</code>. regardless of the route you choose,
know that all strategies support using pinned versions, adherent to semver.
see the <a href="https://github.com/cdaringe/rad/releases">releases page</a>.</p>
<table>
<thead>
<tr>
<th>usage</th>
<th>install-method</th>
<th>install-steps</th>
</tr>
</thead>
<tbody><tr>
<td>cli</td>
<td><code>deno</code></td>
<td><code>deno install rad https://github.com/cdaringe/rad/blob/master/src/bin.ts</code></td>
</tr>
<tr>
<td>cli</td>
<td><code>docker</code></td>
<td><code>docker pull cdaringe/rad</code> <sup>1</sup></td>
</tr>
<tr>
<td>cli</td>
<td><code>curl+sh</code></td>
<td>`curl <todo>.sh</td>
</tr>
<tr>
<td>library</td>
<td><code>deno</code></td>
<td><code>import * as rad from https://github.com/cdaringe/rad/blob/master/src/mod.ts</code></td>
</tr>
</tbody></table>
<p><sup>1</sup>For docker users, consider making a nice shell alias</p>
<pre><code class="language-sh"># shell profile, e.g. .bash_profile
function rad() {
  docker run --rm -v $PWD:/rad cdaringe/rad &quot;$@&quot;;
}</code></pre>
<h2 id="what-is-it">what is it</h2>
<p>a build tool! it competes with make, npm-scripts, bazel, gradle, ant, gulp, or any of the
other many tools out there!</p>
<p><code>rad</code> offers:</p>
<ul>
<li>simple, programmable task interfaces</li>
<li>easy to understand, declarative build steps</li>
<li>type-checked tasks</li>
<li>productive toolkit API for nuanced tasks that benefit from progamming. see <a href="#toolkit">toolkit</a><!-- @todo write toolkit docs--></li>
<li>bottom-up, <code>make</code>-style build targets<ul>
<li>fast builds, skip redundant work when inputs haven&#39;t changed</li>
</ul>
</li>
<li>cli mode, or library mode</li>
<li>portable. build automation for <em>any</em> language or project, in many environments (*limited to <em>Deno</em> target architectures, for the time being. long term, we may package this in <code>Rust</code>)</li>
<li>great UX</li>
<li>no quirky DSLs (<code>make</code>, <code>gradle</code>, and friends 😢). <strong>your build is code</strong>--tasks are typescript &amp; are indeed type-checked!</li>
<li>debuggable. 🐛 inspect your data, tasks, or even <em>rad</em> itself</li>
<li>simplicity of <code>make</code>, without the DSL, coupling to <code>sh</code>, and C/C++ biases</li>
<li>use a real scripting language--<strong>not</strong> <code>bash/sh</code>! shell languages are great for running other programs, not for plumbing data</li>
</ul>
<h2 id="why">why</h2>
<p>🙄, <em>another build tool?</em>.</p>
<p>definitely. no other build tools in <del>2018</del> <del>2019</del> 2020 have a sufficiently
balanced enough feature set that the average polyglot programmer needs without
 coercing it or piling on extraneous complexity.</p>
<p>see <a href="#why-not-my-favorite-build-tool">why not just use <my-favorite-build-tool></a></p>

<h2 id="toolkit">toolkit</h2>
<p><a href="https://github.com/cdaringe/rad/blob/">https://github.com/cdaringe/rad/blob/</a>
f27c5d5f7cd8c40b1cb94b1f659c1b3768c7dc00/src/Task.ts#L33-L42</p>

<h1 id="why-not-my-favorite-build-tool">why not <code>&lt;my-favorite-build-tool&gt;</code>?</h1>
<p>your build tool is probably great. keep using it if you love it.
the intent here it not to dump on anyone or any tool, but articulate feature gaps.</p>
<table>
<thead>
<tr>
<th>tool</th>
<th>DSL-less</th>
<th>static types</th>
<th>standalone</th>
<th>polyglot</th>
<th>incremental</th>
<th>debuggable</th>
<th>beautiful</th>
<th>dependency manager</th>
</tr>
</thead>
<tbody><tr>
<td>bazel</td>
<td></td>
<td></td>
<td></td>
<td>✓</td>
<td>✓</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>gradle</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>✓</td>
<td></td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>gulp/grunt</td>
<td>✓</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>✓</td>
<td>✓</td>
<td></td>
</tr>
<tr>
<td>make</td>
<td></td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npm-scripts</td>
<td>✓</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>✓</td>
</tr>
<tr>
<td>rad</td>
<td>✓</td>
<td>✓</td>
<td></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td></td>
</tr>
</tbody></table>
<p>ant, scons, ninja, etc were omitted. haven&#39;t used &#39;em!</p>
<p>here are some genuine, not-trying-be-rude-opinions.</p>
<p>bazel is complex. maybe you need that complexity. 🤷🏻‍♀️
gradle is full of magic and is often hard to reason about <em>where</em> behavior comes from and is applied.
gulp/grunt have no make-style tasks, are generally node only, comparatively slow, &amp; stringly typed in various places.
make is great, but a lame DSL and is coupled to a bad scripting language
npm-scripts are simple, but suffer releated drawbacks to gulp/grunt.</p>
<p>loose typing, unneeded/obsolete DSLs, lack of great static analysis, and <em>other</em> gaps
leave room for improvement in this space.</p>

<h1 id="rad">rad</h1>
<p>so this is a site huh?</p>

<h2 id="manual">manual</h2>
<p>your guide to <code>rad</code>!</p>
<h3 id="understanding-rad">understanding rad</h3>
<ul>
<li><code>rad</code> is written in typescript and runs on <a href="https://deno.land/">deno</a></li>
<li>you write tasks, then ask <code>rad</code> to run them</li>
<li><code>rad</code> reads your radfile (i.e. <code>rad.ts</code>), compiles &amp; type checks it, then runs it through its task graph executor</li>
</ul>
<p>🤯</p>
<h3 id="setting-up-a-radfile-radts">setting up a radfile, rad.ts</h3>

</div>
<script>
  function paintBabies () {
    let max_rads = 50
    const [w, h] = [ 800, 300 ]
    const center = [w/2, h/2]
    var group = document.getElementById("repeats")
    const xforms = []
    const getTranslateProposal = () => [(Math.random() * w *.85), (h * Math.random())]
    const distance = ([a,b], [x, y]) => Math.sqrt(
      Math.pow(a - x, 2) + Math.pow(b - y, 2)
    )
    const walk = ([a,b], [stepX, stepY] = [10, 30]) => [
      a + ((Math.random()) + stepX) * (Math.random() > 0.5 ? 1 : -1),
      b + ((1 + Math.random()) + stepY) * (Math.random() > 0.5 ? 1 : -1),
    ]
    let i = max_rads
    while (i) {
      let translate = getTranslateProposal()
      while (distance(translate, [700, 280]) < 190) translate = walk(translate)
      xforms.push({
        translate,
        rotate: [360 * Math.random()],
      })
      --i
    }
    const getTransformString = ({ translate, rotate }) => `translate(${translate.join(' ')}) rotate(${rotate.join(' ')}) scale(0.5)`
    if (group.innerHTML) {
      var babies = Array.from(group.children)
      xforms.forEach((xform, i) => { babies[i].setAttribute('transform', getTransformString(xform)) })
    } else {
     group.innerHTML= xforms.map((xform, i) => `
      <use id='baby_${i}' class='text baby-rad' xlink:href="#repeatme"
        transform="${getTransformString(xform)}"
      />
    `).join('')
    }
  }
  paintBabies()
  setTimeout(() => {
    window.requestAnimationFrame(paintBabies)
  }, 500) // gimme one eager animation ;)
  setInterval(paintBabies, 60000)
  document.getElementById('big_baby').addEventListener('click', paintBabies)
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
